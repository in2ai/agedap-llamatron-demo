<!-- Drawer -->
<app-drawer [isOpen]="showConfiguration" (onClose)="onToggleConfiguration()">
  <div class="flex w-full h-full">
    <app-work-space-documents workSpaceType="workOffers" [formGroup]="workSpaceDocumentsForm" />
  </div>
</app-drawer>

<!-- Content -->
<div class="flex flex-col w-full h-full justify-start text-slate-500 p-5">
  <div class="flex flex-col w-full h-full">
    <!-- No workspace l -->
    <div *ngIf="!workSpace" class="flex flex-col items-center">
      <i class="pi pi-spin pi-spinner text-4xl"></i>
      <h1 class="text-xl">Cargando...</h1>
    </div>
    <!-- Workspace details -->
    <div
      *ngIf="workSpace"
      class="flex flex-col w-full h-full justify-start items-start text-slate-500"
    >
      <header class="w-full h-10 border-b border-slate-600 mb-3">
        <div class="flex w-full h-full flex-row justify-between items-center pb-4">
          <h1 class="text-lg font-semibold cursor-pointer" (click)="onBackToWorkSpaces()">
            <i class="pi pi-desktop pr-2"></i>
            <span>Mis espacios de trabajo</span>
          </h1>

          <i class="pi pi-desktio pr-2"></i>
          <span class="cursor-pointer font-bold" (click)="onBackToChats()"
            >| "{{ workSpace.name }}"</span
          >
          <!-- <i class="text-sm" *ngIf="workSpace.createdAt"
            >Created at {{ workSpace.createdAt | isoToLocalddMMYYYYhhmmss }}</i
          > -->
          <div class="cursor-pointer ml-auto" (click)="onToggleConfiguration()">
            <i class="pi pi-cog p-2"></i>
          </div>
        </div>
      </header>

      <!-- Overlay -->
      <div class="flex flex-1 w-full h-full overflow-hidden">
        <!-- New chat overlay -->
        <div *ngIf="isNewChatCreationVisible" class="absolute top-0 left-0 z-10 flex w-full h-full">
          <div class="absolute z-10 flex w-full h-full">
            <app-new-chat-creation
              [workSpaceId]="workSpaceId"
              (onClose)="hideNewChatCreation()"
              (onCreate)="createNewChat($event)"
            />
          </div>
          <div class="relative flex w-full h-full bg-white opacity-50"></div>
        </div>
        <!-- Not chat selected  -->
        <div class="flex flex-1 w-full h-full" *ngIf="!chatId">
          <!-- Not chat created -->
          <section
            *ngIf="!chats || (chats && chats.length === 0)"
            class="flex flex-col w-full h-full justify-center items-center"
          >
            <main class="flex flex-col gap-4 items-center">
              <div><i class="!text-[40px] pi pi-comments text-slate-400"></i></div>
              <p>No tienes ning√∫n chat creado</p>
              <app-button
                (click)="showNewChatCreation()"
                [label]="'CHAT.CREATE_CHAT' | translate"
              />
            </main>
          </section>
          <!-- Chats found -->
          <section *ngIf="chats && chats.length > 0" class="flex flex-col w-full h-full">
            <header>
              <div class="flex flex-row justify-start items-center pb-4">
                <h1 class="text-lg font-semibold">
                  <i class="pi pi-comments pr-2"></i>
                  <span>Chats</span>
                </h1>
              </div>
            </header>
            <main class="relative flex flex-1 workSpaceDetailChats">
              <div class="absolute bottom-3 right-3 z-10">
                <app-button
                  type="secondary"
                  (click)="showNewChatCreation()"
                  [label]="'CHAT.CREATE_CHAT' | translate"
                  icon="plus"
                />
              </div>
              <ag-grid-angular
                style="width: 100%; height: 100%"
                [rowData]="chats"
                [rowClass]="['bg-red']"
                [columnDefs]="colDefs"
                [defaultColDef]="defaultColDef"
                (cellClicked)="onCellClicked($event)"
              />
            </main>
          </section>
        </div>
        <!-- Chat selected  -->
        <div class="flex flex-1 w-full h-full" *ngIf="chatId">
          <!-- Chats found -->
          <section class="flex flex-col w-full h-full">
            <main class="flex flex-col w-full h-full overflow-hidden">
              <app-chat [chatId]="chatId" />
            </main>
          </section>
        </div>
      </div>
    </div>
  </div>
</div>
